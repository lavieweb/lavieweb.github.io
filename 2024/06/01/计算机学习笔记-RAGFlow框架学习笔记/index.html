<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="RAGFlow 框架学习笔记" />
    <meta name="hexo-theme-A4" content="v1.9.6" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Lavie | 落霞与孤鹜齐飞 秋水共长天一色</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: '🌓', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Lavie</a> 
            <span class="description">Lavie 的个人博客，记录了许多自己的生活感悟和计算机专业知识，不太靠谱，希望能让你有所收获。</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">首页</a></li>
            
        
            
                <li><a href="/list/">文章</a></li>
            
        
            
                <li><a href="/about/">关于</a></li>
            
        
            
                <li><a href="/tags/">标签</a></li>
            
        
            
                <li><a href="/categories/">分类</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    RAGFlow 框架学习笔记
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>最近更新：2025-07-17</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>字数总计：3.7k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>阅读估时：16分钟</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        阅读量：<span id="busuanzi_value_page_pv"></span>次
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%80%E3%80%81RAGFlow-%E7%AE%80%E4%BB%8B"><span class="post-toc-text">一、RAGFlow 简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8C%E3%80%81%E6%9E%B6%E6%9E%84%E4%B8%8E%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="post-toc-text">二、架构与核心组件</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%89%E3%80%81%E5%85%B8%E5%9E%8B%E6%B5%81%E7%A8%8B"><span class="post-toc-text">三、典型流程</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9B%9B%E3%80%81RAGFlow-%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8"><span class="post-toc-text">四、RAGFlow 框架使用</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Python-API-%E7%A4%BA%E4%BE%8B"><span class="post-toc-text">Python API 示例</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-RAG-Flow"><span class="post-toc-text">初始化 RAG Flow</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%9F%A5%E8%AF%86%E5%BA%93-dataset-%E7%AE%A1%E7%90%86%E7%9B%B8%E5%85%B3API"><span class="post-toc-text">知识库(dataset)管理相关API</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8D%E5%90%8C%E7%B2%92%E5%BA%A6%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="post-toc-text">创建不同粒度的数据集</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%8D%E5%90%8C%E5%88%86%E5%9D%97%E6%96%B9%E6%B3%95%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="post-toc-text">创建不同分块方法的数据集</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%88%97%E5%87%BA%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="post-toc-text">列出数据集</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E6%9B%B4%E6%96%B0%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="post-toc-text">更新数据集</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="post-toc-text">删除数据集</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="post-toc-text">完整代码</span></a></li></ol></li></ol></li></ol></li></ol>
            
        
        <div class=".article-gallery"><h2 id="一、RAGFlow-简介"><a href="#一、RAGFlow-简介" class="headerlink" title="一、RAGFlow 简介"></a>一、RAGFlow 简介</h2><blockquote>
<p>RAGFlow 是一个开源的检索增强生成（RAG, Retrieval-Augmented Generation）框架，提供了灵活的组件化架构来构建高效的 RAG 系统。本文记录了我学习 RAGFlow 框架的要点与实践体会。</p>
</blockquote>
<p>RAGFlow 由阿里巴巴开源，旨在简化 RAG 系统的开发流程。它支持数据预处理、向量化、检索、生成等全流程，适合快速搭建问答、知识库等 AI 应用。</p>
<h2 id="二、架构与核心组件"><a href="#二、架构与核心组件" class="headerlink" title="二、架构与核心组件"></a>二、架构与核心组件</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌────────────┐   ┌────────────┐   ┌────────────┐</span><br><span class="line">│ 数据预处理  │ → │ 向量存储    │   │  检索生成  │</span><br><span class="line">└────────────┘   └────────────┘   └────────────┘</span><br><span class="line">      │                │                │</span><br><span class="line">      ▼                ▼                ▼</span><br><span class="line">  知识库管理        检索引擎         结果优化</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>Processor</strong>：数据清洗、分割</p>
</li>
<li><p><strong>Embedder</strong>：文本&#x2F;多模态向量化</p>
</li>
<li><p><strong>Retriever</strong>：向量检索</p>
</li>
<li><p><strong>Generator</strong>：大模型生成</p>
</li>
</ul>
<h2 id="三、典型流程"><a href="#三、典型流程" class="headerlink" title="三、典型流程"></a>三、典型流程</h2><ol>
<li><p>数据预处理（分割、清洗）</p>
</li>
<li><p>文本&#x2F;多模态向量化</p>
</li>
<li><p>向量入库</p>
</li>
<li><p>检索相关内容</p>
</li>
<li><p>结合检索结果生成答案</p>
</li>
</ol>
<h2 id="四、RAGFlow-框架使用"><a href="#四、RAGFlow-框架使用" class="headerlink" title="四、RAGFlow 框架使用"></a>四、RAGFlow 框架使用</h2><h3 id="Python-API-示例"><a href="#Python-API-示例" class="headerlink" title="Python API 示例"></a>Python API 示例</h3><h4 id="初始化-RAG-Flow"><a href="#初始化-RAG-Flow" class="headerlink" title="初始化 RAG Flow"></a>初始化 RAG Flow</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rag_object = RAGFlow(api_key=<span class="string">&quot;YOUR_API_KEY&quot;</span>, base_url=<span class="string">&quot;YOUR_BASE_URL&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>其中源代码为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, api_key, base_url, version=<span class="string">&quot;v1&quot;</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    api_url: http://&lt;host_address&gt;/api/v1</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="variable language_">self</span>.user_key = api_key</span><br><span class="line">    <span class="variable language_">self</span>.api_url = <span class="string">f&quot;<span class="subst">&#123;base_url&#125;</span>/api/<span class="subst">&#123;version&#125;</span>&quot;</span></span><br><span class="line">    <span class="variable language_">self</span>.authorization_header = &#123;<span class="string">&quot;Authorization&quot;</span>: <span class="string">&quot;&#123;&#125; &#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="string">&quot;Bearer&quot;</span>, <span class="variable language_">self</span>.user_key)&#125;</span><br></pre></td></tr></table></figure>

<p>上述代码解释：</p>
<ul>
<li><code>api_key</code>：用户 API 密钥，用于身份验证。</li>
<li><code>base_url</code>：RAG Flow 服务器的 URL。</li>
<li><code>version</code>：API 版本，默认为 <code>v1</code>。</li>
</ul>
<p>上述代码主要完成的工作是： 初始化 RAG Flow 客户端。后期的所有操作，我们都是通过对创建好的 RAG Flow 对象，调用对应的 self（相当于 Java 中的 this）成员方法来操作的，比如：</p>
<ul>
<li><p><code>create_dataset</code>：创建数据集。</p>
</li>
<li><p><code>list_datasets</code>：列出数据集。 </p>
</li>
<li><p><code>delete_dataset</code>：删除数据集。</p>
</li>
<li><p><code>create_chat</code>：创建会话。</p>
</li>
</ul>
<p>等等。</p>
<h4 id="知识库-dataset-管理相关API"><a href="#知识库-dataset-管理相关API" class="headerlink" title="知识库(dataset)管理相关API"></a>知识库(dataset)管理相关API</h4><h5 id="创建不同粒度的数据集"><a href="#创建不同粒度的数据集" class="headerlink" title="创建不同粒度的数据集"></a>创建不同粒度的数据集</h5><p><strong>注意，这里需要说明的是，对于 RAG Flow 的前端页面上，我们可以看到有 <code>Knowledge Base</code>，利用前端创建知识库时，会显示配置知识库，此时就需要填写一些内容，而这些内容，刚好对应于代码中的「数据集 dateset」所以，个人认为，可以将代码中的 dataset 理解为知识库。</strong></p>
<p>知识库就是数据集。</p>
<p><a href="/images/%E7%9F%A5%E8%AF%86%E5%BA%93%E5%B0%B1%E6%98%AF%E6%95%B0%E6%8D%AE%E9%9B%86.png" title="知识库就是数据集" class="gallery-item" style="box-shadow: none;"> <img src="/images/%E7%9F%A5%E8%AF%86%E5%BA%93%E5%B0%B1%E6%98%AF%E6%95%B0%E6%8D%AE%E9%9B%86.png" alt="知识库就是数据集"></a></p>
<p>因此，下方代码中的创建数据集，就是页面上的创建知识库。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_dataset</span>(<span class="params"></span></span><br><span class="line"><span class="params">    self,</span></span><br><span class="line"><span class="params">    name: <span class="built_in">str</span>,</span></span><br><span class="line"><span class="params">    avatar: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    description: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params">    embedding_model: <span class="type">Optional</span>[<span class="built_in">str</span>] = <span class="string">&quot;BAAI/bge-large-zh-v1.5@BAAI&quot;</span>,</span></span><br><span class="line"><span class="params">    permission: <span class="built_in">str</span> = <span class="string">&quot;me&quot;</span>,</span></span><br><span class="line"><span class="params">    chunk_method: <span class="built_in">str</span> = <span class="string">&quot;naive&quot;</span>,</span></span><br><span class="line"><span class="params">    parser_config: <span class="type">Optional</span>[DataSet.ParserConfig] = <span class="literal">None</span>,</span></span><br><span class="line"><span class="params"></span>) -&gt; DataSet:</span><br><span class="line">    payload = &#123;</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        <span class="string">&quot;avatar&quot;</span>: avatar,</span><br><span class="line">        <span class="string">&quot;description&quot;</span>: description,</span><br><span class="line">        <span class="string">&quot;embedding_model&quot;</span>: embedding_model,</span><br><span class="line">        <span class="string">&quot;permission&quot;</span>: permission,</span><br><span class="line">        <span class="string">&quot;chunk_method&quot;</span>: chunk_method,</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> parser_config <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>:</span><br><span class="line">        payload[<span class="string">&quot;parser_config&quot;</span>] = parser_config.to_json()</span><br><span class="line"></span><br><span class="line">    res = <span class="variable language_">self</span>.post(<span class="string">&quot;/datasets&quot;</span>, payload)</span><br><span class="line">    res = res.json()</span><br><span class="line">    <span class="keyword">if</span> res.get(<span class="string">&quot;code&quot;</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> DataSet(<span class="variable language_">self</span>, res[<span class="string">&quot;data&quot;</span>])</span><br><span class="line">    <span class="keyword">raise</span> Exception(res[<span class="string">&quot;message&quot;</span>])</span><br></pre></td></tr></table></figure>

<h5 id="创建不同分块方法的数据集"><a href="#创建不同分块方法的数据集" class="headerlink" title="创建不同分块方法的数据集"></a>创建不同分块方法的数据集</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">create_dataset_example</span>(<span class="params">self</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;创建数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=== 创建数据集示例 ===&quot;</span>)</span><br><span class="line">    created_datasets = []</span><br><span class="line">    chunk_methods = [</span><br><span class="line">        <span class="string">&quot;naive&quot;</span>,</span><br><span class="line">        <span class="string">&quot;manual&quot;</span>,</span><br><span class="line">        <span class="string">&quot;qa&quot;</span>,</span><br><span class="line">        <span class="string">&quot;table&quot;</span>,</span><br><span class="line">        <span class="string">&quot;paper&quot;</span>,</span><br><span class="line">        <span class="string">&quot;book&quot;</span>,</span><br><span class="line">        <span class="string">&quot;laws&quot;</span>,</span><br><span class="line">        <span class="string">&quot;presentation&quot;</span>,</span><br><span class="line">        <span class="string">&quot;picture&quot;</span>,</span><br><span class="line">        <span class="string">&quot;one&quot;</span>,</span><br><span class="line">        <span class="string">&quot;email&quot;</span>,</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">for</span> method <span class="keyword">in</span> chunk_methods:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            dataset = <span class="variable language_">self</span>.rag_object.create_dataset(</span><br><span class="line">                name=<span class="string">f&quot;kb_<span class="subst">&#123;method&#125;</span>_<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>&quot;</span>,</span><br><span class="line">                description=<span class="string">f&quot;使用 <span class="subst">&#123;method&#125;</span> 分块方法的数据集&quot;</span>,</span><br><span class="line">                chunk_method=method,</span><br><span class="line">                embedding_model=<span class="string">&quot;BAAI/bge-large-zh-v1.5@BAAI&quot;</span>,</span><br><span class="line">                permission=<span class="string">&quot;me&quot;</span>,</span><br><span class="line">            )</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;创建<span class="subst">&#123;method&#125;</span>数据集: <span class="subst">&#123;dataset.name&#125;</span> (ID: <span class="subst">&#123;dataset.<span class="built_in">id</span>&#125;</span>)&quot;</span>)</span><br><span class="line">            created_datasets.append(dataset)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;创建<span class="subst">&#123;method&#125;</span>数据集失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> created_datasets</span><br></pre></td></tr></table></figure>

<p>上述方法，会创建 11 个数据集，分别使用不同的分块方法，这些分块方法用于常见的文档类型，比如：<br>以下是 <strong>RAGFlow 框架中的 <code>chunk_methods</code></strong> 的分类及每种分块方法的简单介绍，结合其适用场景和特点：</p>
<hr>
<ol>
<li><strong><code>naive</code>（通用分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>默认分块方法，适合处理常规文本。</li>
<li>使用自然分隔符（如换行符、标点符号）切分，同时控制块大小（通常不超过指定的 Token 数）。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>通用文档，如政策文件、产品说明等格式较规范的文本。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>简单高效，无需复杂配置。</li>
</ul>
<hr>
<ol>
<li><strong><code>manual</code>（手动分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>仅支持 PDF 格式，假设文档具有分层结构（如章节标题）。</li>
<li>使用最低级别的标题作为切片基准，保留章节内的图表和表格完整性，块大小可能较大。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>手册类文档，如设备手册、技术规范等。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>保留章节内容完整性，适合逻辑紧密的文档。</li>
</ul>
<hr>
<ol start="3">
<li><strong><code>qa</code>（问答格式分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于问答对格式的文档。</li>
<li>如果是 Excel 文件，需两列分别存储问题和答案；如果是 CSV&#x2F;TXT 文件，以 TAB 分隔问题和答案。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>问答对形式的知识库，例如常见问题解答（FAQ）。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>适合问答场景，检索精准。</li>
</ul>
<hr>
<ol start="4">
<li><strong><code>table</code>（表格分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于表格数据，将表中每一行作为一个块。</li>
<li>支持 CSV、TXT 和 Excel 文件，列标题必须有意义。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>表格数据，如统计报表、数据库导出文件。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>保留表格结构，支持行列检索。</li>
</ul>
<hr>
<ol start="5">
<li><strong><code>paper</code>（论文分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于学术论文，按论文章节（如摘要、引言、方法等）切分。</li>
<li>增强论文的结构化检索能力。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>PDF 格式的学术论文。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提高论文检索和引用精度，但计算成本较高。</li>
</ul>
<hr>
<ol start="6">
<li><strong><code>book</code>（书籍分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于书籍文档，支持按章节或页面范围切分。</li>
<li>块大小可调整，适合长文档。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>书籍或长篇文档，如小说、技术书籍。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>保留书籍逻辑结构，适合全文检索。</li>
</ul>
<hr>
<ol start="7">
<li><strong><code>laws</code>（法律分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于法律文件，利用文本特征（如条款号）切分。</li>
<li>块粒度通常与条款一致，包含相关上下文。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>合同、法律法规文件。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>检索精准，适配法律文件的严格格式。</li>
</ul>
<hr>
<ol start="8">
<li><strong><code>presentation</code>（演示文稿分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于 PPT 或 PDF 格式的演示文稿。</li>
<li>每页幻灯片作为一个块，同时存储缩略图。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>幻灯片文件，如报告、演示材料。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>保留幻灯片结构，支持视觉化检索。</li>
</ul>
<hr>
<ol start="9">
<li><strong><code>picture</code>（图片分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于图片文档，支持 OCR（文字识别）和布局分析。</li>
<li>图片中的文字和标题被识别后作为块处理。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>图片或扫描件。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>可处理非结构化图片文档，支持图文检索。</li>
</ul>
<hr>
<ol start="10">
<li><strong><code>one</code>（单一文档块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>将整个文档作为一个块处理，不进行分割。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>短文档或需要全文检索的场景。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>保留文档完整性，适合全文检索。</li>
</ul>
<hr>
<ol start="11">
<li><strong><code>email</code>（电子邮件分块）</strong><br><strong>特点</strong>：</li>
</ol>
<ul>
<li>专用于邮件文件，解析邮件内容并按邮件主题或段落切分。</li>
</ul>
<p><strong>适用场景</strong>：</p>
<ul>
<li>电子邮件或邮件存档。</li>
</ul>
<p><strong>优点</strong>：</p>
<ul>
<li>提取邮件关键信息，便于邮件检索。</li>
</ul>
<hr>
<h5 id="列出数据集"><a href="#列出数据集" class="headerlink" title="列出数据集"></a>列出数据集</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">list_datasets</span>(<span class="params">self, page: <span class="built_in">int</span> = <span class="number">1</span>, page_size: <span class="built_in">int</span> = <span class="number">30</span>, orderby: <span class="built_in">str</span> = <span class="string">&quot;create_time&quot;</span>, desc: <span class="built_in">bool</span> = <span class="literal">True</span>, <span class="built_in">id</span>: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span>, name: <span class="built_in">str</span> | <span class="literal">None</span> = <span class="literal">None</span></span>) -&gt; <span class="built_in">list</span>[DataSet]:</span><br><span class="line">    res = <span class="variable language_">self</span>.get(</span><br><span class="line">        <span class="string">&quot;/datasets&quot;</span>,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">&quot;page&quot;</span>: page,</span><br><span class="line">            <span class="string">&quot;page_size&quot;</span>: page_size,</span><br><span class="line">            <span class="string">&quot;orderby&quot;</span>: orderby,</span><br><span class="line">            <span class="string">&quot;desc&quot;</span>: desc,</span><br><span class="line">            <span class="string">&quot;id&quot;</span>: <span class="built_in">id</span>,</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: name,</span><br><span class="line">        &#125;,</span><br><span class="line">    )</span><br><span class="line">    res = res.json()</span><br><span class="line">    result_list = []</span><br><span class="line">    <span class="keyword">if</span> res.get(<span class="string">&quot;code&quot;</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">for</span> data <span class="keyword">in</span> res[<span class="string">&quot;data&quot;</span>]:</span><br><span class="line">            result_list.append(DataSet(<span class="variable language_">self</span>, data))</span><br><span class="line">        <span class="keyword">return</span> result_list</span><br><span class="line">    <span class="keyword">raise</span> Exception(res[<span class="string">&quot;message&quot;</span>])</span><br></pre></td></tr></table></figure>

<p>上述方法用于列出数据集，并返回一个包含所有数据集的列表。</p>
<p>其可选的查询参数说明如下：</p>
<ul>
<li><p>page: 页码，默认为1</p>
</li>
<li><p>page_size: 每页数量，默认30</p>
</li>
<li><p>orderby: 排序字段，默认为create_time</p>
</li>
<li><p>desc: 是否倒序，默认True</p>
</li>
<li><p>id: 数据集ID <strong>注意，这里存在一个权限问题，对于填了 me 权限的，团队的其他用户是无法搜索到的，哪怕ID正确。</strong></p>
</li>
<li><p>name: 数据集名称</p>
</li>
</ul>
<ol>
<li><p>查询所有数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 列出所有数据集</span></span><br><span class="line">all_datasets = <span class="variable language_">self</span>.rag_object.list_datasets()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;总共有<span class="subst">&#123;<span class="built_in">len</span>(all_datasets)&#125;</span> 个数据集:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> all_datasets:</span><br><span class="line">    <span class="built_in">print</span>(</span><br><span class="line">        <span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span> (ID: <span class="subst">&#123;dataset.<span class="built_in">id</span>&#125;</span>, 创建时间: <span class="subst">&#123;<span class="built_in">getattr</span>(dataset, <span class="string">&#x27;create_time&#x27;</span>, <span class="string">&#x27;N/A&#x27;</span>)&#125;</span>)&quot;</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
</li>
<li><p>指定页编码以及页数，分页查询数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. 分页列出数据集</span></span><br><span class="line">page_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(page=<span class="number">1</span>, page_size=<span class="number">5</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n第一页数据集 (每页5个):&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> page_datasets:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>按更新时间排序查询数据集</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">time_sorted_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(</span><br><span class="line">    orderby=<span class="string">&quot;update_time&quot;</span>, desc=<span class="literal">True</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n按更新时间排序的数据集:&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> time_sorted_datasets[:<span class="number">3</span>]:  <span class="comment"># 只显示前3个</span></span><br><span class="line">    <span class="built_in">print</span>(</span><br><span class="line">        <span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span> (更新时间: <span class="subst">&#123;<span class="built_in">getattr</span>(dataset, <span class="string">&#x27;update_time&#x27;</span>, <span class="string">&#x27;N/A&#x27;</span>)&#125;</span>)&quot;</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历所有数据集，检查权限</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. 遍历所有数据集，分别输出有权限和无权限的数据集</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n=== 遍历所有数据集，检查权限 ===&quot;</span>)</span><br><span class="line">has_permission = []</span><br><span class="line">no_permission = []</span><br><span class="line"><span class="keyword">for</span> dataset <span class="keyword">in</span> all_datasets:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 尝试用ID查找，能查到说明有权限</span></span><br><span class="line">        <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset.<span class="built_in">id</span>)</span><br><span class="line">        has_permission.append(dataset.name)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        no_permission.append(dataset.name)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;\n当前用户有权限的数据集: <span class="subst">&#123;has_permission&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;当前用户无权限的数据集: <span class="subst">&#123;no_permission&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ol>
<h5 id="更新数据集"><a href="#更新数据集" class="headerlink" title="更新数据集"></a>更新数据集</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">update_dataset_example</span>(<span class="params">self, dataset_id: <span class="built_in">str</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;更新数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;\n=== 更新数据集示例 (ID: <span class="subst">&#123;dataset_id&#125;</span>) ===&quot;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 更新数据集名称和描述</span></span><br><span class="line">        update_message = &#123;</span><br><span class="line">            <span class="string">&quot;name&quot;</span>: <span class="string">&quot;updated_kb&quot;</span>,</span><br><span class="line">            <span class="string">&quot;description&quot;</span>: <span class="string">&quot;已更新的知识库数据集&quot;</span>,</span><br><span class="line">            <span class="string">&quot;embedding_model&quot;</span>: <span class="string">&quot;text-embedding-v2&quot;</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 获取数据集对象</span></span><br><span class="line">        datasets = <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset_id)</span><br><span class="line">        <span class="keyword">if</span> datasets:</span><br><span class="line">            dataset = datasets[<span class="number">0</span>]</span><br><span class="line">            dataset.update(update_message)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;数据集更新成功: <span class="subst">&#123;dataset.name&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="comment"># 验证更新结果</span></span><br><span class="line">            updated_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset_id)</span><br><span class="line">            <span class="keyword">if</span> updated_datasets:</span><br><span class="line">                updated_dataset = updated_datasets[<span class="number">0</span>]</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;更新后的数据集信息:&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  名称: <span class="subst">&#123;updated_dataset.name&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  描述: <span class="subst">&#123;updated_dataset.description&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;  嵌入模型: <span class="subst">&#123;updated_dataset.embedding_model&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;未找到ID为 <span class="subst">&#123;dataset_id&#125;</span> 的数据集&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;更新数据集失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="删除数据集"><a href="#删除数据集" class="headerlink" title="删除数据集"></a>删除数据集</h5><h5 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DatasetManager</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, api_key: <span class="built_in">str</span>, base_url: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;初始化RAGFlow客户端&quot;&quot;&quot;</span></span><br><span class="line">        <span class="variable language_">self</span>.rag_object = RAGFlow(api_key=api_key, base_url=base_url)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">create_dataset_example</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;创建数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== 创建数据集示例 ===&quot;</span>)</span><br><span class="line">        created_datasets = []</span><br><span class="line">        chunk_methods = [</span><br><span class="line">            <span class="string">&quot;naive&quot;</span>,</span><br><span class="line">            <span class="string">&quot;manual&quot;</span>,</span><br><span class="line">            <span class="string">&quot;qa&quot;</span>,</span><br><span class="line">            <span class="string">&quot;table&quot;</span>,</span><br><span class="line">            <span class="string">&quot;paper&quot;</span>,</span><br><span class="line">            <span class="string">&quot;book&quot;</span>,</span><br><span class="line">            <span class="string">&quot;laws&quot;</span>,</span><br><span class="line">            <span class="string">&quot;presentation&quot;</span>,</span><br><span class="line">            <span class="string">&quot;picture&quot;</span>,</span><br><span class="line">            <span class="string">&quot;one&quot;</span>,</span><br><span class="line">            <span class="string">&quot;email&quot;</span>,</span><br><span class="line">        ]</span><br><span class="line">        <span class="keyword">for</span> method <span class="keyword">in</span> chunk_methods:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                dataset = <span class="variable language_">self</span>.rag_object.create_dataset(</span><br><span class="line">                    name=<span class="string">f&quot;kb_<span class="subst">&#123;method&#125;</span>_<span class="subst">&#123;<span class="built_in">int</span>(time.time())&#125;</span>&quot;</span>,</span><br><span class="line">                    description=<span class="string">f&quot;使用 <span class="subst">&#123;method&#125;</span> 分块方法的数据集&quot;</span>,</span><br><span class="line">                    chunk_method=method,</span><br><span class="line">                    embedding_model=<span class="string">&quot;BAAI/bge-large-zh-v1.5@BAAI&quot;</span>,</span><br><span class="line">                    permission=<span class="string">&quot;me&quot;</span>,</span><br><span class="line">                )</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;创建<span class="subst">&#123;method&#125;</span>数据集: <span class="subst">&#123;dataset.name&#125;</span> (ID: <span class="subst">&#123;dataset.<span class="built_in">id</span>&#125;</span>)&quot;</span>)</span><br><span class="line">                created_datasets.append(dataset)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;创建<span class="subst">&#123;method&#125;</span>数据集失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> created_datasets</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_get_parser_config</span>(<span class="params">self, chunk_method: <span class="built_in">str</span></span>) -&gt; <span class="type">Optional</span>[<span class="type">Any</span>]:</span><br><span class="line">        <span class="string">&quot;&quot;&quot;根据分块方法获取解析器配置&quot;&quot;&quot;</span></span><br><span class="line">        configs = &#123;</span><br><span class="line">            <span class="string">&quot;naive&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;chunk_token_num&quot;</span>: <span class="number">512</span>,</span><br><span class="line">                <span class="string">&quot;delimiter&quot;</span>: <span class="string">&quot;\n&quot;</span>,</span><br><span class="line">                <span class="string">&quot;html4excel&quot;</span>: <span class="literal">False</span>,</span><br><span class="line">                <span class="string">&quot;layout_recognize&quot;</span>: <span class="literal">True</span>,</span><br><span class="line">                <span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;qa&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;manual&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;table&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;paper&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;book&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;laws&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;picture&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;presentation&quot;</span>: &#123;<span class="string">&quot;raptor&quot;</span>: &#123;<span class="string">&quot;use_raptor&quot;</span>: <span class="literal">False</span>&#125;&#125;,</span><br><span class="line">            <span class="string">&quot;one&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">            <span class="string">&quot;knowledge-graph&quot;</span>: &#123;</span><br><span class="line">                <span class="string">&quot;chunk_token_num&quot;</span>: <span class="number">128</span>,</span><br><span class="line">                <span class="string">&quot;delimiter&quot;</span>: <span class="string">&quot;\n&quot;</span>,</span><br><span class="line">                <span class="string">&quot;entity_types&quot;</span>: [<span class="string">&quot;organization&quot;</span>, <span class="string">&quot;person&quot;</span>, <span class="string">&quot;location&quot;</span>, <span class="string">&quot;event&quot;</span>, <span class="string">&quot;time&quot;</span>],</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">&quot;email&quot;</span>: <span class="literal">None</span>,</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> configs.get(chunk_method)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">list_datasets_example</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;列出数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== 列出数据集示例 ===&quot;</span>)</span><br><span class="line">        <span class="comment"># 1. 列出所有数据集</span></span><br><span class="line">        all_datasets = <span class="variable language_">self</span>.rag_object.list_datasets()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;总共有<span class="subst">&#123;<span class="built_in">len</span>(all_datasets)&#125;</span> 个数据集:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> dataset <span class="keyword">in</span> all_datasets:</span><br><span class="line">            <span class="built_in">print</span>(</span><br><span class="line">                <span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span> (ID: <span class="subst">&#123;dataset.<span class="built_in">id</span>&#125;</span>, 创建时间: <span class="subst">&#123;<span class="built_in">getattr</span>(dataset, <span class="string">&#x27;create_time&#x27;</span>, <span class="string">&#x27;N/A&#x27;</span>)&#125;</span>)&quot;</span></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 分页列出数据集</span></span><br><span class="line">        page_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(page=<span class="number">1</span>, page_size=<span class="number">5</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n第一页数据集 (每页5个):&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> dataset <span class="keyword">in</span> page_datasets:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 3. 按更新时间排序</span></span><br><span class="line">        time_sorted_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(</span><br><span class="line">            orderby=<span class="string">&quot;update_time&quot;</span>, desc=<span class="literal">True</span></span><br><span class="line">        )</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n按更新时间排序的数据集:&quot;</span>)</span><br><span class="line">        <span class="keyword">for</span> dataset <span class="keyword">in</span> time_sorted_datasets[:<span class="number">3</span>]:  <span class="comment"># 只显示前3个</span></span><br><span class="line">            <span class="built_in">print</span>(</span><br><span class="line">                <span class="string">f&quot;  - <span class="subst">&#123;dataset.name&#125;</span> (更新时间: <span class="subst">&#123;<span class="built_in">getattr</span>(dataset, <span class="string">&#x27;update_time&#x27;</span>, <span class="string">&#x27;N/A&#x27;</span>)&#125;</span>)&quot;</span></span><br><span class="line">            )</span><br><span class="line">        <span class="comment"># 4. 遍历所有数据集，分别输出有权限和无权限的数据集</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;\n=== 遍历所有数据集，检查权限 ===&quot;</span>)</span><br><span class="line">        has_permission = []</span><br><span class="line">        no_permission = []</span><br><span class="line">        <span class="keyword">for</span> dataset <span class="keyword">in</span> all_datasets:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="comment"># 尝试用ID查找，能查到说明有权限</span></span><br><span class="line">                <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset.<span class="built_in">id</span>)</span><br><span class="line">                has_permission.append(dataset.name)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                no_permission.append(dataset.name)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n当前用户有权限的数据集: <span class="subst">&#123;has_permission&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;当前用户无权限的数据集: <span class="subst">&#123;no_permission&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">update_dataset_example</span>(<span class="params">self, dataset_id: <span class="built_in">str</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;更新数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n=== 更新数据集示例 (ID: <span class="subst">&#123;dataset_id&#125;</span>) ===&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment"># 更新数据集名称和描述</span></span><br><span class="line">            update_message = &#123;</span><br><span class="line">                <span class="string">&quot;name&quot;</span>: <span class="string">&quot;updated_kb&quot;</span>,</span><br><span class="line">                <span class="string">&quot;description&quot;</span>: <span class="string">&quot;已更新的知识库数据集&quot;</span>,</span><br><span class="line">                <span class="string">&quot;embedding_model&quot;</span>: <span class="string">&quot;text-embedding-v2&quot;</span>,</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment"># 获取数据集对象</span></span><br><span class="line">            datasets = <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset_id)</span><br><span class="line">            <span class="keyword">if</span> datasets:</span><br><span class="line">                dataset = datasets[<span class="number">0</span>]</span><br><span class="line">                dataset.update(update_message)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;数据集更新成功: <span class="subst">&#123;dataset.name&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="comment"># 验证更新结果</span></span><br><span class="line">                updated_datasets = <span class="variable language_">self</span>.rag_object.list_datasets(<span class="built_in">id</span>=dataset_id)</span><br><span class="line">                <span class="keyword">if</span> updated_datasets:</span><br><span class="line">                    updated_dataset = updated_datasets[<span class="number">0</span>]</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;更新后的数据集信息:&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  名称: <span class="subst">&#123;updated_dataset.name&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  描述: <span class="subst">&#123;updated_dataset.description&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;  嵌入模型: <span class="subst">&#123;updated_dataset.embedding_model&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;未找到ID为 <span class="subst">&#123;dataset_id&#125;</span> 的数据集&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;更新数据集失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">delete_datasets_example</span>(<span class="params">self, dataset_ids: <span class="type">List</span>[<span class="built_in">str</span>]</span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;删除数据集的示例&quot;&quot;&quot;</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n=== 删除数据集示例 ===&quot;</span>)</span><br><span class="line">        <span class="comment"># 1. 删除指定数据集</span></span><br><span class="line">        <span class="keyword">if</span> dataset_ids:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                <span class="variable language_">self</span>.rag_object.delete_datasets(ids=dataset_ids)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;成功删除 <span class="subst">&#123;<span class="built_in">len</span>(dataset_ids)&#125;</span> 个数据集&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;删除数据集失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="comment"># 2. 删除空列表（不删除任何数据集）</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="variable language_">self</span>.rag_object.delete_datasets(ids=[])</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;空列表删除操作完成（未删除任何数据集）&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;空列表删除操作失败: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;主函数 - 演示数据集管理的完整流程&quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 配置信息</span></span><br><span class="line">    API_KEY = <span class="string">&quot;ragflow-ZjMDYyNDQwNjIxNzExZjBhMjgyMDI0Mm&quot;</span>  <span class="comment"># 例如：&quot;abc123def456&quot;</span></span><br><span class="line">    BASE_URL = <span class="string">&quot;http://localhost:9380&quot;</span>  <span class="comment"># 例如：&quot;http://localhost:9380&quot;</span></span><br><span class="line">    <span class="comment"># 创建数据集管理器</span></span><br><span class="line">    dataset_manager = DatasetManager(API_KEY, BASE_URL)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 1. 创建数据集</span></span><br><span class="line">        created_datasets = dataset_manager.create_dataset_example()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2. 列出数据集</span></span><br><span class="line">        dataset_manager.list_datasets_example()</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3. 更新数据集</span></span><br><span class="line">        <span class="comment"># if created_datasets:</span></span><br><span class="line">        <span class="comment">#     dataset_manager.update_dataset_example(created_datasets[0].id)</span></span><br><span class="line">        <span class="comment"># 4. 删除数据集（可选）</span></span><br><span class="line">        <span class="comment"># dataset_ids = [dataset.id for dataset in created_datasets]</span></span><br><span class="line">        <span class="comment"># dataset_manager.delete_datasets_example(dataset_ids)</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;执行过程中发生错误: <span class="subst">&#123;e&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2024-06-01</span>
            
                <span>该篇文章被 Shuilang He</span>
            
            
                <span>打上标签:
                    
                    
                        <a href='/tags/RAG/'>
                            RAG
                        </a>
                    
                        <a href='/tags/%E6%A1%86%E6%9E%B6/'>
                            框架
                        </a>
                    
                        <a href='/tags/AI/'>
                            AI
                        </a>
                    
                        <a href='/tags/%E6%A3%80%E7%B4%A2%E5%A2%9E%E5%BC%BA%E7%94%9F%E6%88%90/'>
                            检索增强生成
                        </a>
                    
                </span>
             
             
                <span>归为分类:
                    
                    
                        <a href='/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/'>
                            计算机学习笔记
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>上一篇：<a href='/2024/08/07/%E5%8F%A3%E8%AF%AD%E8%A7%92-Do_You_Really_Need_8_Hours_of_Sleep_Every_Night/'>Do You Really Need 8 Hours of Sleep Every Night</a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/2023/08/06/%E5%8F%A3%E8%AF%AD%E8%A7%92-%E5%8F%91%E8%A8%80%E6%89%8B%E7%A8%BF/">Manuscripts for English Corner</a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            © 1949-2024 China 

            
                

            
        </span>
       
    
</div>



<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>🌊落霞与孤鹜齐飞 秋水共长天一色🌊</span>
            
                <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // 启用插件
            thumbnail: true,          // 显示缩略图
            zoom: true,               // 启用缩放功
            rotate: true,             // 启用旋转功能能
            autoplay: true,        // 启用自动播放功能
            fullScreen: true,      // 启用全屏功能
            pager: false, //页码,
            zoomFromOrigin: true,   // 从原始位置缩放
            actualSize: true,       // 启用查看实际大小的功能
            enableZoomAfter: 300,    // 延迟缩放，确保图片加载完成后可缩放
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // 修复选择器
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>